function out = larter_breakspear
out{1} = @init;
out{2} = @fun_eval;
out{3} = @jacobian;
out{4} = @jacobianp;
out{5} = @hessians;
out{6} = @hessiansp;
out{7} = @der3;
out{8} = @der4;
out{9} = @der5;

% --------------------------------------------------------------------------
function dydt = fun_eval(t,kmrgd,par_TCa,par_dCa,par_gCa,par_VCa,par_TK,par_dK,par_gK,par_VK,par_TNa,par_dNa,par_gNa,par_VNa,par_VL,par_gL,par_VT,par_ZT,par_dVZ,par_QVm,par_QZm,par_I,par_aee,par_aei,par_aie,par_ane,par_ani,par_BB,par_phi,par_tauk,par_rNMDA)
QV=0.5*par_QVm*(1+tanh((kmrgd(1)-par_VT)/par_dVZ));;
QZ=0.5*par_QZm*(1+tanh((kmrgd(2)-par_ZT)/par_dVZ));;
dydt=[-(par_gCa+par_rNMDA*par_aee*QV)*(0.5*(1+tanh((kmrgd(1)-par_TCa)/par_dCa)))*(kmrgd(1)-par_VCa)-par_gK*kmrgd(3)*(kmrgd(1)-par_VK)-par_gL*(kmrgd(1)-par_VL)-(par_gNa*(0.5*(1+tanh((kmrgd(1)-par_TNa)/par_dNa)))+par_aee*QV)*(kmrgd(1)-par_VNa)-par_aie*kmrgd(2)*QZ+par_ane*par_I;;
par_BB*(par_ani*par_I+par_aei*kmrgd(1)*QV);;
par_phi*((0.5*(1+tanh((kmrgd(1)-par_TK)/par_dK)))-kmrgd(3))/par_tauk;;];

% --------------------------------------------------------------------------
function [tspan,y0,options] = init
handles = feval(larter_breakspear);
y0=[0,0,0];
options = odeset('Jacobian',handles(3),'JacobianP',handles(4),'Hessians',handles(5),'HessiansP',handles(6));
tspan = [0 10];

% --------------------------------------------------------------------------
function jac = jacobian(t,kmrgd,par_TCa,par_dCa,par_gCa,par_VCa,par_TK,par_dK,par_gK,par_VK,par_TNa,par_dNa,par_gNa,par_VNa,par_VL,par_gL,par_VT,par_ZT,par_dVZ,par_QVm,par_QZm,par_I,par_aee,par_aei,par_aie,par_ane,par_ani,par_BB,par_phi,par_tauk,par_rNMDA)
jac=[ (kmrgd(1) - par_VNa)*((par_gNa*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/(2*par_dNa) + (par_QVm*par_aee*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ)) - kmrgd(3)*par_gK - (par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2) - par_gNa*(tanh((kmrgd(1) - par_TNa)/par_dNa)/2 + 1/2) - par_gL - (par_QVm*par_aee*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2 + ((par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(2*par_dCa) + (par_QVm*par_aee*par_rNMDA*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ) , (kmrgd(2)*par_QZm*par_aie*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/(2*par_dVZ) - (par_QZm*par_aie*(tanh((kmrgd(2) - par_ZT)/par_dVZ) + 1))/2 , -par_gK*(kmrgd(1) - par_VK) ; par_BB*((par_QVm*par_aei*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2 - (kmrgd(1)*par_QVm*par_aei*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ)) , 0 , 0 ; -(par_phi*(tanh((kmrgd(1) - par_TK)/par_dK)^2 - 1))/(2*par_dK*par_tauk) , 0 , -par_phi/par_tauk ];
% --------------------------------------------------------------------------
function jacp = jacobianp(t,kmrgd,par_TCa,par_dCa,par_gCa,par_VCa,par_TK,par_dK,par_gK,par_VK,par_TNa,par_dNa,par_gNa,par_VNa,par_VL,par_gL,par_VT,par_ZT,par_dVZ,par_QVm,par_QZm,par_I,par_aee,par_aei,par_aie,par_ane,par_ani,par_BB,par_phi,par_tauk,par_rNMDA)
jacp=[ -((par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(2*par_dCa) , -((par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(kmrgd(1) - par_TCa)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(2*par_dCa^2) , -(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2) , (par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2) , 0 , 0 , -kmrgd(3)*(kmrgd(1) - par_VK) , kmrgd(3)*par_gK , -(par_gNa*(kmrgd(1) - par_VNa)*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/(2*par_dNa) , -(par_gNa*(kmrgd(1) - par_TNa)*(kmrgd(1) - par_VNa)*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/(2*par_dNa^2) , -(kmrgd(1) - par_VNa)*(tanh((kmrgd(1) - par_TNa)/par_dNa)/2 + 1/2) , par_gNa*(tanh((kmrgd(1) - par_TNa)/par_dNa)/2 + 1/2) + (par_QVm*par_aee*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2 , par_gL , par_VL - kmrgd(1) , - (par_QVm*par_aee*(kmrgd(1) - par_VNa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ) - (par_QVm*par_aee*par_rNMDA*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ) , -(kmrgd(2)*par_QZm*par_aie*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/(2*par_dVZ) , - (par_QVm*par_aee*(kmrgd(1) - par_VT)*(kmrgd(1) - par_VNa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ^2) - (kmrgd(2)*par_QZm*par_aie*(kmrgd(2) - par_ZT)*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/(2*par_dVZ^2) - (par_QVm*par_aee*par_rNMDA*(kmrgd(1) - par_VT)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ^2) , - (par_aee*(kmrgd(1) - par_VNa)*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2 - (par_aee*par_rNMDA*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2))/2 , -(kmrgd(2)*par_aie*(tanh((kmrgd(2) - par_ZT)/par_dVZ) + 1))/2 , par_ane , - (par_QVm*(kmrgd(1) - par_VNa)*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2 - (par_QVm*par_rNMDA*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2))/2 , 0 , -(kmrgd(2)*par_QZm*(tanh((kmrgd(2) - par_ZT)/par_dVZ) + 1))/2 , par_I , 0 , 0 , 0 , 0 , -(par_QVm*par_aee*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2))/2 ; 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , (kmrgd(1)*par_BB*par_QVm*par_aei*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ) , 0 , (kmrgd(1)*par_BB*par_QVm*par_aei*(kmrgd(1) - par_VT)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ^2) , (kmrgd(1)*par_BB*par_aei*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2 , 0 , par_BB*par_ani , 0 , (kmrgd(1)*par_BB*par_QVm*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2 , 0 , 0 , par_I*par_BB , par_I*par_ani + (kmrgd(1)*par_QVm*par_aei*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2 , 0 , 0 , 0 ; 0 , 0 , 0 , 0 , (par_phi*(tanh((kmrgd(1) - par_TK)/par_dK)^2 - 1))/(2*par_dK*par_tauk) , (par_phi*(kmrgd(1) - par_TK)*(tanh((kmrgd(1) - par_TK)/par_dK)^2 - 1))/(2*par_dK^2*par_tauk) , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , (tanh((kmrgd(1) - par_TK)/par_dK)/2 - kmrgd(3) + 1/2)/par_tauk , -(par_phi*(tanh((kmrgd(1) - par_TK)/par_dK)/2 - kmrgd(3) + 1/2))/par_tauk^2 , 0 ];
% --------------------------------------------------------------------------
function hess = hessians(t,kmrgd,par_TCa,par_dCa,par_gCa,par_VCa,par_TK,par_dK,par_gK,par_VK,par_TNa,par_dNa,par_gNa,par_VNa,par_VL,par_gL,par_VT,par_ZT,par_dVZ,par_QVm,par_QZm,par_I,par_aee,par_aei,par_aie,par_ane,par_ani,par_BB,par_phi,par_tauk,par_rNMDA)
hess1=[ ((par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/par_dCa - ((par_gNa*tanh((kmrgd(1) - par_TNa)/par_dNa)*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/par_dNa^2 + (par_QVm*par_aee*tanh((kmrgd(1) - par_VT)/par_dVZ)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^2)*(kmrgd(1) - par_VNa) + (par_gNa*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/par_dNa + (par_QVm*par_aee*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ - (tanh((kmrgd(1) - par_TCa)/par_dCa)*(par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/par_dCa^2 + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ - (par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^2 - (par_QVm*par_aee*par_rNMDA*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(2*par_dCa*par_dVZ) , 0 , -par_gK ; -par_BB*((par_QVm*par_aei*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ - (kmrgd(1)*par_QVm*par_aei*tanh((kmrgd(1) - par_VT)/par_dVZ)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^2) , 0 , 0 ; (par_phi*tanh((kmrgd(1) - par_TK)/par_dK)*(tanh((kmrgd(1) - par_TK)/par_dK)^2 - 1))/(par_dK^2*par_tauk) , 0 , 0 ];
hess2=[ 0 , (par_QZm*par_aie*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/par_dVZ - (kmrgd(2)*par_QZm*par_aie*tanh((kmrgd(2) - par_ZT)/par_dVZ)*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/par_dVZ^2 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hess3=[ -par_gK , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hess(:,:,1) =hess1;
hess(:,:,2) =hess2;
hess(:,:,3) =hess3;
% --------------------------------------------------------------------------
function hessp = hessiansp(t,kmrgd,par_TCa,par_dCa,par_gCa,par_VCa,par_TK,par_dK,par_gK,par_VK,par_TNa,par_dNa,par_gNa,par_VNa,par_VL,par_gL,par_VT,par_ZT,par_dVZ,par_QVm,par_QZm,par_I,par_aee,par_aei,par_aie,par_ane,par_ani,par_BB,par_phi,par_tauk,par_rNMDA)
hessp1=[ (tanh((kmrgd(1) - par_TCa)/par_dCa)*(par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/par_dCa^2 - ((par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(2*par_dCa) + (par_QVm*par_aee*par_rNMDA*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(4*par_dCa*par_dVZ) , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp2=[ (tanh((kmrgd(1) - par_TCa)/par_dCa)*(par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(kmrgd(1) - par_TCa)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/par_dCa^3 - ((par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(2*par_dCa^2) - ((par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(kmrgd(1) - par_TCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(2*par_dCa^2) + (par_QVm*par_aee*par_rNMDA*(kmrgd(1) - par_TCa)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(4*par_dCa^2*par_dVZ) , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp3=[ ((kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(2*par_dCa) - tanh((kmrgd(1) - par_TCa)/par_dCa)/2 - 1/2 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp4=[ - ((par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(2*par_dCa) - (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ) , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp5=[ 0 , 0 , 0 ; 0 , 0 , 0 ; -(par_phi*tanh((kmrgd(1) - par_TK)/par_dK)*(tanh((kmrgd(1) - par_TK)/par_dK)^2 - 1))/(par_dK^2*par_tauk) , 0 , 0 ];
hessp6=[ 0 , 0 , 0 ; 0 , 0 , 0 ; (par_phi*(tanh((kmrgd(1) - par_TK)/par_dK)^2 - 1))/(2*par_dK^2*par_tauk) - (par_phi*tanh((kmrgd(1) - par_TK)/par_dK)*(kmrgd(1) - par_TK)*(tanh((kmrgd(1) - par_TK)/par_dK)^2 - 1))/(par_dK^3*par_tauk) , 0 , 0 ];
hessp7=[ -kmrgd(3) , 0 , par_VK - kmrgd(1) ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp8=[ 0 , 0 , par_gK ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp9=[ (par_gNa*tanh((kmrgd(1) - par_TNa)/par_dNa)*(kmrgd(1) - par_VNa)*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/par_dNa^2 - (par_gNa*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/(2*par_dNa) , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp10=[ - ((par_gNa*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/(2*par_dNa^2) - (par_gNa*tanh((kmrgd(1) - par_TNa)/par_dNa)*(kmrgd(1) - par_TNa)*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/par_dNa^3)*(kmrgd(1) - par_VNa) - (par_gNa*(kmrgd(1) - par_TNa)*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/(2*par_dNa^2) , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp11=[ ((kmrgd(1) - par_VNa)*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/(2*par_dNa) - tanh((kmrgd(1) - par_TNa)/par_dNa)/2 - 1/2 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp12=[ - (par_gNa*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/(2*par_dNa) - (par_QVm*par_aee*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ) , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp13=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp14=[ -1 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp15=[ (par_QVm*par_aee*tanh((kmrgd(1) - par_VT)/par_dVZ)*(kmrgd(1) - par_VNa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^2 - (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ) - (par_QVm*par_aee*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ) + (par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^2 + (par_QVm*par_aee*par_rNMDA*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(4*par_dCa*par_dVZ) , 0 , 0 ; par_BB*((par_QVm*par_aei*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ) - (kmrgd(1)*par_QVm*par_aei*tanh((kmrgd(1) - par_VT)/par_dVZ)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^2) , 0 , 0 ; 0 , 0 , 0 ];
hessp16=[ 0 , (kmrgd(2)*par_QZm*par_aie*tanh((kmrgd(2) - par_ZT)/par_dVZ)*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/par_dVZ^2 - (par_QZm*par_aie*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/(2*par_dVZ) , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp17=[ (par_QVm*par_aee*par_rNMDA*(kmrgd(1) - par_VT)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(4*par_dCa*par_dVZ^2) - (par_QVm*par_aee*(kmrgd(1) - par_VT)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ^2) - (par_QVm*par_aee*par_rNMDA*(kmrgd(1) - par_VT)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ^2) - (par_QVm*par_aee*par_rNMDA*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ^2) - ((par_QVm*par_aee*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ^2) - (par_QVm*par_aee*tanh((kmrgd(1) - par_VT)/par_dVZ)*(kmrgd(1) - par_VT)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^3)*(kmrgd(1) - par_VNa) + (par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)*(kmrgd(1) - par_VT)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^3 , (kmrgd(2)*par_QZm*par_aie*tanh((kmrgd(2) - par_ZT)/par_dVZ)*(kmrgd(2) - par_ZT)*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/par_dVZ^3 - (par_QZm*par_aie*(kmrgd(2) - par_ZT)*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/(2*par_dVZ^2) - (kmrgd(2)*par_QZm*par_aie*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/(2*par_dVZ^2) , 0 ; par_BB*((kmrgd(1)*par_QVm*par_aei*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ^2) + (par_QVm*par_aei*(kmrgd(1) - par_VT)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ^2) - (kmrgd(1)*par_QVm*par_aei*tanh((kmrgd(1) - par_VT)/par_dVZ)*(kmrgd(1) - par_VT)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^3) , 0 , 0 ; 0 , 0 , 0 ];
hessp18=[ (par_aee*(kmrgd(1) - par_VNa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ) - (par_aee*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2 - (par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2))/2 + (par_aee*par_rNMDA*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(4*par_dCa) + (par_aee*par_rNMDA*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ) , 0 , 0 ; par_BB*((par_aei*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2 - (kmrgd(1)*par_aei*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ)) , 0 , 0 ; 0 , 0 , 0 ];
hessp19=[ 0 , (kmrgd(2)*par_aie*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/(2*par_dVZ) - (par_aie*(tanh((kmrgd(2) - par_ZT)/par_dVZ) + 1))/2 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp20=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp21=[ (par_QVm*(kmrgd(1) - par_VNa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ) - (par_QVm*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2 - (par_QVm*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2))/2 + (par_QVm*par_rNMDA*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(4*par_dCa) + (par_QVm*par_rNMDA*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ) , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp22=[ 0 , 0 , 0 ; par_BB*((par_QVm*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2 - (kmrgd(1)*par_QVm*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ)) , 0 , 0 ; 0 , 0 , 0 ];
hessp23=[ 0 , (kmrgd(2)*par_QZm*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/(2*par_dVZ) - (par_QZm*(tanh((kmrgd(2) - par_ZT)/par_dVZ) + 1))/2 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp24=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp25=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp26=[ 0 , 0 , 0 ; (par_QVm*par_aei*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2 - (kmrgd(1)*par_QVm*par_aei*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ) , 0 , 0 ; 0 , 0 , 0 ];
hessp27=[ 0 , 0 , 0 ; 0 , 0 , 0 ; -(tanh((kmrgd(1) - par_TK)/par_dK)^2 - 1)/(2*par_dK*par_tauk) , 0 , -1/par_tauk ];
hessp28=[ 0 , 0 , 0 ; 0 , 0 , 0 ; (par_phi*(tanh((kmrgd(1) - par_TK)/par_dK)^2 - 1))/(2*par_dK*par_tauk^2) , 0 , par_phi/par_tauk^2 ];
hessp29=[ (par_QVm*par_aee*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(4*par_dCa) - (par_QVm*par_aee*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2))/2 + (par_QVm*par_aee*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/(2*par_dVZ) , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
hessp(:,:,1) =hessp1;
hessp(:,:,2) =hessp2;
hessp(:,:,3) =hessp3;
hessp(:,:,4) =hessp4;
hessp(:,:,5) =hessp5;
hessp(:,:,6) =hessp6;
hessp(:,:,7) =hessp7;
hessp(:,:,8) =hessp8;
hessp(:,:,9) =hessp9;
hessp(:,:,10) =hessp10;
hessp(:,:,11) =hessp11;
hessp(:,:,12) =hessp12;
hessp(:,:,13) =hessp13;
hessp(:,:,14) =hessp14;
hessp(:,:,15) =hessp15;
hessp(:,:,16) =hessp16;
hessp(:,:,17) =hessp17;
hessp(:,:,18) =hessp18;
hessp(:,:,19) =hessp19;
hessp(:,:,20) =hessp20;
hessp(:,:,21) =hessp21;
hessp(:,:,22) =hessp22;
hessp(:,:,23) =hessp23;
hessp(:,:,24) =hessp24;
hessp(:,:,25) =hessp25;
hessp(:,:,26) =hessp26;
hessp(:,:,27) =hessp27;
hessp(:,:,28) =hessp28;
hessp(:,:,29) =hessp29;
%---------------------------------------------------------------------------
function tens3  = der3(t,kmrgd,par_TCa,par_dCa,par_gCa,par_VCa,par_TK,par_dK,par_gK,par_VK,par_TNa,par_dNa,par_gNa,par_VNa,par_VL,par_gL,par_VT,par_ZT,par_dVZ,par_QVm,par_QZm,par_I,par_aee,par_aei,par_aie,par_ane,par_ani,par_BB,par_phi,par_tauk,par_rNMDA)
tens31=[ (kmrgd(1) - par_VNa)*((par_gNa*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1)^2)/par_dNa^3 + (2*par_gNa*tanh((kmrgd(1) - par_TNa)/par_dNa)^2*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/par_dNa^3 + (par_QVm*par_aee*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2)/par_dVZ^3 + (2*par_QVm*par_aee*tanh((kmrgd(1) - par_VT)/par_dVZ)^2*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^3) + ((par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1)^2)/par_dCa^3 - (3*tanh((kmrgd(1) - par_TCa)/par_dCa)*(par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/par_dCa^2 - (3*par_gNa*tanh((kmrgd(1) - par_TNa)/par_dNa)*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/par_dNa^2 - (3*par_QVm*par_aee*tanh((kmrgd(1) - par_VT)/par_dVZ)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^2 + (2*tanh((kmrgd(1) - par_TCa)/par_dCa)^2*(par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/par_dCa^3 - (3*par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(2*par_dCa*par_dVZ) + (par_QVm*par_aee*par_rNMDA*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2)/par_dVZ^3 - (3*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^2 + (2*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)^2*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^3 + (3*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(2*par_dCa*par_dVZ^2) + (3*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_TCa)/par_dCa)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(2*par_dCa^2*par_dVZ) , 0 , 0 ; -par_BB*((kmrgd(1)*par_QVm*par_aei*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2)/par_dVZ^3 - (3*par_QVm*par_aei*tanh((kmrgd(1) - par_VT)/par_dVZ)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^2 + (2*kmrgd(1)*par_QVm*par_aei*tanh((kmrgd(1) - par_VT)/par_dVZ)^2*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^3) , 0 , 0 ; - (par_phi*(tanh((kmrgd(1) - par_TK)/par_dK)^2 - 1)^2)/(par_dK^3*par_tauk) - (2*par_phi*tanh((kmrgd(1) - par_TK)/par_dK)^2*(tanh((kmrgd(1) - par_TK)/par_dK)^2 - 1))/(par_dK^3*par_tauk) , 0 , 0 ];
tens32=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens33=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens34=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens35=[ 0 , (kmrgd(2)*par_QZm*par_aie*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1)^2)/par_dVZ^3 - (3*par_QZm*par_aie*tanh((kmrgd(2) - par_ZT)/par_dVZ)*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/par_dVZ^2 + (2*kmrgd(2)*par_QZm*par_aie*tanh((kmrgd(2) - par_ZT)/par_dVZ)^2*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/par_dVZ^3 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens36=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens37=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens38=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens39=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens3(:,:,1,1) =tens31;
tens3(:,:,1,2) =tens32;
tens3(:,:,1,3) =tens33;
tens3(:,:,2,1) =tens34;
tens3(:,:,2,2) =tens35;
tens3(:,:,2,3) =tens36;
tens3(:,:,3,1) =tens37;
tens3(:,:,3,2) =tens38;
tens3(:,:,3,3) =tens39;
%---------------------------------------------------------------------------
function tens4  = der4(t,kmrgd,par_TCa,par_dCa,par_gCa,par_VCa,par_TK,par_dK,par_gK,par_VK,par_TNa,par_dNa,par_gNa,par_VNa,par_VL,par_gL,par_VT,par_ZT,par_dVZ,par_QVm,par_QZm,par_I,par_aee,par_aei,par_aie,par_ane,par_ani,par_BB,par_phi,par_tauk,par_rNMDA)
tens41=[ (4*(par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1)^2)/par_dCa^3 - (kmrgd(1) - par_VNa)*((8*par_gNa*tanh((kmrgd(1) - par_TNa)/par_dNa)*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1)^2)/par_dNa^4 + (4*par_gNa*tanh((kmrgd(1) - par_TNa)/par_dNa)^3*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/par_dNa^4 + (8*par_QVm*par_aee*tanh((kmrgd(1) - par_VT)/par_dVZ)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2)/par_dVZ^4 + (4*par_QVm*par_aee*tanh((kmrgd(1) - par_VT)/par_dVZ)^3*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^4) + (4*par_gNa*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1)^2)/par_dNa^3 + (8*par_gNa*tanh((kmrgd(1) - par_TNa)/par_dNa)^2*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/par_dNa^3 + (4*par_QVm*par_aee*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2)/par_dVZ^3 + (8*tanh((kmrgd(1) - par_TCa)/par_dCa)^2*(par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/par_dCa^3 - (8*tanh((kmrgd(1) - par_TCa)/par_dCa)*(par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1)^2)/par_dCa^4 - (4*tanh((kmrgd(1) - par_TCa)/par_dCa)^3*(par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/par_dCa^4 + (8*par_QVm*par_aee*tanh((kmrgd(1) - par_VT)/par_dVZ)^2*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^3 + (4*par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2)/par_dVZ^3 + (8*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)^2*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^3 - (2*par_QVm*par_aee*par_rNMDA*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(par_dCa*par_dVZ^3) - (2*par_QVm*par_aee*par_rNMDA*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1)^2)/(par_dCa^3*par_dVZ) + (6*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(par_dCa*par_dVZ^2) + (6*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_TCa)/par_dCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(par_dCa^2*par_dVZ) - (8*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2)/par_dVZ^4 - (4*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)^3*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^4 - (4*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)^2*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(par_dCa*par_dVZ^3) - (4*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_TCa)/par_dCa)^2*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(par_dCa^3*par_dVZ) - (6*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)*tanh((kmrgd(1) - par_TCa)/par_dCa)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(par_dCa^2*par_dVZ^2) , 0 , 0 ; -par_BB*((4*par_QVm*par_aei*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2)/par_dVZ^3 + (8*par_QVm*par_aei*tanh((kmrgd(1) - par_VT)/par_dVZ)^2*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^3 - (8*kmrgd(1)*par_QVm*par_aei*tanh((kmrgd(1) - par_VT)/par_dVZ)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2)/par_dVZ^4 - (4*kmrgd(1)*par_QVm*par_aei*tanh((kmrgd(1) - par_VT)/par_dVZ)^3*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^4) , 0 , 0 ; (8*par_phi*tanh((kmrgd(1) - par_TK)/par_dK)*(tanh((kmrgd(1) - par_TK)/par_dK)^2 - 1)^2)/(par_dK^4*par_tauk) + (4*par_phi*tanh((kmrgd(1) - par_TK)/par_dK)^3*(tanh((kmrgd(1) - par_TK)/par_dK)^2 - 1))/(par_dK^4*par_tauk) , 0 , 0 ];
tens42=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens43=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens44=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens45=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens46=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens47=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens48=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens49=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens410=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens411=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens412=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens413=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens414=[ 0 , (4*par_QZm*par_aie*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1)^2)/par_dVZ^3 + (8*par_QZm*par_aie*tanh((kmrgd(2) - par_ZT)/par_dVZ)^2*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/par_dVZ^3 - (8*kmrgd(2)*par_QZm*par_aie*tanh((kmrgd(2) - par_ZT)/par_dVZ)*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1)^2)/par_dVZ^4 - (4*kmrgd(2)*par_QZm*par_aie*tanh((kmrgd(2) - par_ZT)/par_dVZ)^3*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/par_dVZ^4 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens415=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens416=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens417=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens418=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens419=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens420=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens421=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens422=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens423=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens424=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens425=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens426=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens427=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens4(:,:,1,1,1) =tens41;
tens4(:,:,1,1,2) =tens42;
tens4(:,:,1,1,3) =tens43;
tens4(:,:,1,2,1) =tens44;
tens4(:,:,1,2,2) =tens45;
tens4(:,:,1,2,3) =tens46;
tens4(:,:,1,3,1) =tens47;
tens4(:,:,1,3,2) =tens48;
tens4(:,:,1,3,3) =tens49;
tens4(:,:,2,1,1) =tens410;
tens4(:,:,2,1,2) =tens411;
tens4(:,:,2,1,3) =tens412;
tens4(:,:,2,2,1) =tens413;
tens4(:,:,2,2,2) =tens414;
tens4(:,:,2,2,3) =tens415;
tens4(:,:,2,3,1) =tens416;
tens4(:,:,2,3,2) =tens417;
tens4(:,:,2,3,3) =tens418;
tens4(:,:,3,1,1) =tens419;
tens4(:,:,3,1,2) =tens420;
tens4(:,:,3,1,3) =tens421;
tens4(:,:,3,2,1) =tens422;
tens4(:,:,3,2,2) =tens423;
tens4(:,:,3,2,3) =tens424;
tens4(:,:,3,3,1) =tens425;
tens4(:,:,3,3,2) =tens426;
tens4(:,:,3,3,3) =tens427;
%---------------------------------------------------------------------------
function tens5  = der5(t,kmrgd,par_TCa,par_dCa,par_gCa,par_VCa,par_TK,par_dK,par_gK,par_VK,par_TNa,par_dNa,par_gNa,par_VNa,par_VL,par_gL,par_VT,par_ZT,par_dVZ,par_QVm,par_QZm,par_I,par_aee,par_aei,par_aie,par_ane,par_ani,par_BB,par_phi,par_tauk,par_rNMDA)
tens51=[ (kmrgd(1) - par_VNa)*((8*par_gNa*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1)^3)/par_dNa^5 + (8*par_gNa*tanh((kmrgd(1) - par_TNa)/par_dNa)^4*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/par_dNa^5 + (8*par_QVm*par_aee*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^3)/par_dVZ^5 + (44*par_gNa*tanh((kmrgd(1) - par_TNa)/par_dNa)^2*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1)^2)/par_dNa^5 + (8*par_QVm*par_aee*tanh((kmrgd(1) - par_VT)/par_dVZ)^4*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^5 + (44*par_QVm*par_aee*tanh((kmrgd(1) - par_VT)/par_dVZ)^2*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2)/par_dVZ^5) - (40*par_gNa*tanh((kmrgd(1) - par_TNa)/par_dNa)*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1)^2)/par_dNa^4 - (20*par_gNa*tanh((kmrgd(1) - par_TNa)/par_dNa)^3*(tanh((kmrgd(1) - par_TNa)/par_dNa)^2 - 1))/par_dNa^4 + (8*(par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1)^3)/par_dCa^5 - (40*tanh((kmrgd(1) - par_TCa)/par_dCa)*(par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1)^2)/par_dCa^4 - (20*tanh((kmrgd(1) - par_TCa)/par_dCa)^3*(par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/par_dCa^4 + (8*tanh((kmrgd(1) - par_TCa)/par_dCa)^4*(par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/par_dCa^5 - (40*par_QVm*par_aee*tanh((kmrgd(1) - par_VT)/par_dVZ)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2)/par_dVZ^4 - (20*par_QVm*par_aee*tanh((kmrgd(1) - par_VT)/par_dVZ)^3*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^4 + (44*tanh((kmrgd(1) - par_TCa)/par_dCa)^2*(par_gCa + (par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ) + 1))/2)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1)^2)/par_dCa^5 - (40*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2)/par_dVZ^4 - (20*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)^3*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^4 + (8*par_QVm*par_aee*par_rNMDA*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^3)/par_dVZ^5 - (10*par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(par_dCa*par_dVZ^3) - (10*par_QVm*par_aee*par_rNMDA*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1)^2)/(par_dCa^3*par_dVZ) + (8*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)^4*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^5 - (20*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)^2*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(par_dCa*par_dVZ^3) - (20*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_TCa)/par_dCa)^2*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(par_dCa^3*par_dVZ) + (44*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)^2*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_TCa)/par_dCa)/2 + 1/2)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2)/par_dVZ^5 + (20*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(par_dCa*par_dVZ^4) + (10*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1)^2)/(par_dCa^3*par_dVZ^2) + (10*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)^3*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(par_dCa*par_dVZ^4) + (10*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_TCa)/par_dCa)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(par_dCa^2*par_dVZ^3) + (20*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_TCa)/par_dCa)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1)^2)/(par_dCa^4*par_dVZ) + (10*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_TCa)/par_dCa)^3*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(par_dCa^4*par_dVZ) - (30*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)*tanh((kmrgd(1) - par_TCa)/par_dCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(par_dCa^2*par_dVZ^2) + (20*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)^2*tanh((kmrgd(1) - par_TCa)/par_dCa)*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(par_dCa^2*par_dVZ^3) + (20*par_QVm*par_aee*par_rNMDA*tanh((kmrgd(1) - par_VT)/par_dVZ)*tanh((kmrgd(1) - par_TCa)/par_dCa)^2*(kmrgd(1) - par_VCa)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)*(tanh((kmrgd(1) - par_TCa)/par_dCa)^2 - 1))/(par_dCa^3*par_dVZ^2) , 0 , 0 ; -par_BB*((8*kmrgd(1)*par_QVm*par_aei*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^3)/par_dVZ^5 - (20*par_QVm*par_aei*tanh((kmrgd(1) - par_VT)/par_dVZ)^3*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^4 - (40*par_QVm*par_aei*tanh((kmrgd(1) - par_VT)/par_dVZ)*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2)/par_dVZ^4 + (44*kmrgd(1)*par_QVm*par_aei*tanh((kmrgd(1) - par_VT)/par_dVZ)^2*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1)^2)/par_dVZ^5 + (8*kmrgd(1)*par_QVm*par_aei*tanh((kmrgd(1) - par_VT)/par_dVZ)^4*(tanh((kmrgd(1) - par_VT)/par_dVZ)^2 - 1))/par_dVZ^5) , 0 , 0 ; - (8*par_phi*(tanh((kmrgd(1) - par_TK)/par_dK)^2 - 1)^3)/(par_dK^5*par_tauk) - (44*par_phi*tanh((kmrgd(1) - par_TK)/par_dK)^2*(tanh((kmrgd(1) - par_TK)/par_dK)^2 - 1)^2)/(par_dK^5*par_tauk) - (8*par_phi*tanh((kmrgd(1) - par_TK)/par_dK)^4*(tanh((kmrgd(1) - par_TK)/par_dK)^2 - 1))/(par_dK^5*par_tauk) , 0 , 0 ];
tens52=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens53=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens54=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens55=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens56=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens57=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens58=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens59=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens510=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens511=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens512=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens513=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens514=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens515=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens516=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens517=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens518=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens519=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens520=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens521=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens522=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens523=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens524=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens525=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens526=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens527=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens528=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens529=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens530=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens531=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens532=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens533=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens534=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens535=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens536=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens537=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens538=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens539=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens540=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens541=[ 0 , (8*kmrgd(2)*par_QZm*par_aie*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1)^3)/par_dVZ^5 - (20*par_QZm*par_aie*tanh((kmrgd(2) - par_ZT)/par_dVZ)^3*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/par_dVZ^4 - (40*par_QZm*par_aie*tanh((kmrgd(2) - par_ZT)/par_dVZ)*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1)^2)/par_dVZ^4 + (44*kmrgd(2)*par_QZm*par_aie*tanh((kmrgd(2) - par_ZT)/par_dVZ)^2*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1)^2)/par_dVZ^5 + (8*kmrgd(2)*par_QZm*par_aie*tanh((kmrgd(2) - par_ZT)/par_dVZ)^4*(tanh((kmrgd(2) - par_ZT)/par_dVZ)^2 - 1))/par_dVZ^5 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens542=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens543=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens544=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens545=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens546=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens547=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens548=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens549=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens550=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens551=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens552=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens553=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens554=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens555=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens556=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens557=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens558=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens559=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens560=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens561=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens562=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens563=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens564=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens565=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens566=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens567=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens568=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens569=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens570=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens571=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens572=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens573=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens574=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens575=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens576=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens577=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens578=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens579=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens580=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens581=[ 0 , 0 , 0 ; 0 , 0 , 0 ; 0 , 0 , 0 ];
tens5(:,:,1,1,1,1) =tens51;
tens5(:,:,1,1,1,2) =tens52;
tens5(:,:,1,1,1,3) =tens53;
tens5(:,:,1,1,2,1) =tens54;
tens5(:,:,1,1,2,2) =tens55;
tens5(:,:,1,1,2,3) =tens56;
tens5(:,:,1,1,3,1) =tens57;
tens5(:,:,1,1,3,2) =tens58;
tens5(:,:,1,1,3,3) =tens59;
tens5(:,:,1,2,1,1) =tens510;
tens5(:,:,1,2,1,2) =tens511;
tens5(:,:,1,2,1,3) =tens512;
tens5(:,:,1,2,2,1) =tens513;
tens5(:,:,1,2,2,2) =tens514;
tens5(:,:,1,2,2,3) =tens515;
tens5(:,:,1,2,3,1) =tens516;
tens5(:,:,1,2,3,2) =tens517;
tens5(:,:,1,2,3,3) =tens518;
tens5(:,:,1,3,1,1) =tens519;
tens5(:,:,1,3,1,2) =tens520;
tens5(:,:,1,3,1,3) =tens521;
tens5(:,:,1,3,2,1) =tens522;
tens5(:,:,1,3,2,2) =tens523;
tens5(:,:,1,3,2,3) =tens524;
tens5(:,:,1,3,3,1) =tens525;
tens5(:,:,1,3,3,2) =tens526;
tens5(:,:,1,3,3,3) =tens527;
tens5(:,:,2,1,1,1) =tens528;
tens5(:,:,2,1,1,2) =tens529;
tens5(:,:,2,1,1,3) =tens530;
tens5(:,:,2,1,2,1) =tens531;
tens5(:,:,2,1,2,2) =tens532;
tens5(:,:,2,1,2,3) =tens533;
tens5(:,:,2,1,3,1) =tens534;
tens5(:,:,2,1,3,2) =tens535;
tens5(:,:,2,1,3,3) =tens536;
tens5(:,:,2,2,1,1) =tens537;
tens5(:,:,2,2,1,2) =tens538;
tens5(:,:,2,2,1,3) =tens539;
tens5(:,:,2,2,2,1) =tens540;
tens5(:,:,2,2,2,2) =tens541;
tens5(:,:,2,2,2,3) =tens542;
tens5(:,:,2,2,3,1) =tens543;
tens5(:,:,2,2,3,2) =tens544;
tens5(:,:,2,2,3,3) =tens545;
tens5(:,:,2,3,1,1) =tens546;
tens5(:,:,2,3,1,2) =tens547;
tens5(:,:,2,3,1,3) =tens548;
tens5(:,:,2,3,2,1) =tens549;
tens5(:,:,2,3,2,2) =tens550;
tens5(:,:,2,3,2,3) =tens551;
tens5(:,:,2,3,3,1) =tens552;
tens5(:,:,2,3,3,2) =tens553;
tens5(:,:,2,3,3,3) =tens554;
tens5(:,:,3,1,1,1) =tens555;
tens5(:,:,3,1,1,2) =tens556;
tens5(:,:,3,1,1,3) =tens557;
tens5(:,:,3,1,2,1) =tens558;
tens5(:,:,3,1,2,2) =tens559;
tens5(:,:,3,1,2,3) =tens560;
tens5(:,:,3,1,3,1) =tens561;
tens5(:,:,3,1,3,2) =tens562;
tens5(:,:,3,1,3,3) =tens563;
tens5(:,:,3,2,1,1) =tens564;
tens5(:,:,3,2,1,2) =tens565;
tens5(:,:,3,2,1,3) =tens566;
tens5(:,:,3,2,2,1) =tens567;
tens5(:,:,3,2,2,2) =tens568;
tens5(:,:,3,2,2,3) =tens569;
tens5(:,:,3,2,3,1) =tens570;
tens5(:,:,3,2,3,2) =tens571;
tens5(:,:,3,2,3,3) =tens572;
tens5(:,:,3,3,1,1) =tens573;
tens5(:,:,3,3,1,2) =tens574;
tens5(:,:,3,3,1,3) =tens575;
tens5(:,:,3,3,2,1) =tens576;
tens5(:,:,3,3,2,2) =tens577;
tens5(:,:,3,3,2,3) =tens578;
tens5(:,:,3,3,3,1) =tens579;
tens5(:,:,3,3,3,2) =tens580;
tens5(:,:,3,3,3,3) =tens581;
